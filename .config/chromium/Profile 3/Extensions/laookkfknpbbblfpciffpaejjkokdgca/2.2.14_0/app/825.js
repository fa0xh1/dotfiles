(self.webpackChunkmomentum_extension=self.webpackChunkmomentum_extension||[]).push([[825],{4224:(n,t,e)=>{"use strict";e.r(t),e.d(t,{default:()=>h});var a=e(4525),i=function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("transition",{attrs:{name:"fade"},on:{"after-leave":n.afterLeave}},[n.showIntro?e("div",{staticClass:"intro",attrs:{id:"introduction","data-test":"introduction"},on:{click:n.focusInput}},[e("div",{staticClass:"intro-top"},[e("img",{staticClass:"logo",attrs:{src:"img/logo-white.svg"}})]),n._v(" "),e("div",{staticClass:"intro-middle u--scrim"},[e("transition",{attrs:{name:"fade",mode:"out-in"},on:{enter:n.focusInput}},[n.activeStep?e("div",{key:n.activeStepId,staticClass:"intro-middle-wrapper"},[n.isThirdPartyEmail?e("div",{staticClass:"question"},[n._v(n._s(n.thirdPartyMsg))]):[e("span",{staticClass:"question",class:n.activeStep.stepClass,attrs:{"data-test":"question"}},[n._v("\n\t\t\t\t\t\t\t"+n._s(n.message)+"\n\t\t\t\t\t\t")]),n._v(" "),e("div",{staticClass:"input-wrapper",class:{"has-text-input":"password"!==n.activeStep.inputType},attrs:{"data-value":n.inputValue}},["password"===n.activeStep.valueType?e("span",{staticClass:"input-left-column",attrs:{"data-test":"input-left-column"}}):n._e(),n._v(" "),e("span",{staticClass:"input-center-column",attrs:{"data-test":"input-center-column"}},["checkbox"!==(n.showInputText?"text":n.activeStep.inputType||"text")||n.activeStep.hideInput?"radio"!==(n.showInputText?"text":n.activeStep.inputType||"text")||n.activeStep.hideInput?n.activeStep.hideInput?n._e():e("input",{directives:[{name:"model",rawName:"v-model",value:n.inputValue,expression:"inputValue"}],ref:"input",staticClass:"input",class:n.activeStep.inputClass,attrs:{id:"introduction-input",spellcheck:"false",name:"notASearchFieldSafari","data-test":n.activeStep.dataTest,type:n.showInputText?"text":n.activeStep.inputType||"text"},domProps:{value:n.inputValue},on:{keydown:[n.onKeydown,function(t){return!t.type.indexOf("key")&&n._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:n.handleSpaceInput(t)}],input:[function(t){t.target.composing||(n.inputValue=t.target.value)},n.onInput],click:function(n){n.stopPropagation()}}}):e("input",{directives:[{name:"model",rawName:"v-model",value:n.inputValue,expression:"inputValue"}],ref:"input",staticClass:"input",class:n.activeStep.inputClass,attrs:{id:"introduction-input",spellcheck:"false",name:"notASearchFieldSafari","data-test":n.activeStep.dataTest,type:"radio"},domProps:{checked:n._q(n.inputValue,null)},on:{keydown:[n.onKeydown,function(t){return!t.type.indexOf("key")&&n._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:n.handleSpaceInput(t)}],input:n.onInput,click:function(n){n.stopPropagation()},change:function(t){n.inputValue=null}}}):e("input",{directives:[{name:"model",rawName:"v-model",value:n.inputValue,expression:"inputValue"}],ref:"input",staticClass:"input",class:n.activeStep.inputClass,attrs:{id:"introduction-input",spellcheck:"false",name:"notASearchFieldSafari","data-test":n.activeStep.dataTest,type:"checkbox"},domProps:{checked:Array.isArray(n.inputValue)?n._i(n.inputValue,null)>-1:n.inputValue},on:{keydown:[n.onKeydown,function(t){return!t.type.indexOf("key")&&n._k(t.keyCode,"space",32,t.key,[" ","Spacebar"])?null:n.handleSpaceInput(t)}],input:n.onInput,click:function(n){n.stopPropagation()},change:function(t){var e=n.inputValue,a=t.target,i=!!a.checked;if(Array.isArray(e)){var s=n._i(e,null);a.checked?s<0&&(n.inputValue=e.concat([null])):s>-1&&(n.inputValue=e.slice(0,s).concat(e.slice(s+1)))}else n.inputValue=i}}}),n._v(" "),e("span",{staticClass:"hidden-span"},[n._v(n._s(n.hiddenSpanValue))])]),n._v(" "),"password"===n.activeStep.valueType?e("button",{staticClass:"input-right-column",attrs:{title:n.passwordVisibilityTitle,"data-test":"input-right-column"},on:{click:n.togglePasswordVisibility}},[n.showInputText?e("svg",{staticClass:"password-visibility-icon",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 487.55 487.55",fill:"white"}},[e("path",{attrs:{d:"M481.325 227.515c-27.818-32-55.305-56.9-82.209-75.868l-71.547 71.547a86.194 86.194 0 0 1 2.256 27.521c-3.3 41.4-36.8 75-78.3 78.3a86.053 86.053 0 0 1-27.557-2.22l-50.8 50.8c149.186 45.178 269.006-72.279 308.156-117.179a24.848 24.848 0 0 0 .001-32.901zM409.382 78.168a15 15 0 0 0-21.213 0L345.4 120.943C178.878 47.491 43.284 185.378 4.925 230.315a20.309 20.309 0 0 0-.1 26.4c37.365 43.612 74.149 74.351 109.746 95.052l-36.4 36.4a15 15 0 0 0 21.213 21.213l310-310a15 15 0 0 0-.002-21.212zM159.425 236.915c3.3-41.4 36.8-75 78.3-78.3A84.968 84.968 0 0 1 293 173.343l-118.87 118.87a85.122 85.122 0 0 1-14.705-55.298z"}})]):e("svg",{staticClass:"password-visibility-icon",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 487.55 487.55",fill:"white"}},[e("path",{attrs:{d:"M481.325 227.515c-224.8-258.6-428-53.9-476.4 2.8-6.5 7.6-6.6 18.8-.1 26.4 221.9 259 423.4 64.6 476.5 3.7 8.3-9.4 8.3-23.4 0-32.9zm-151.5 23.2c-3.3 41.4-36.8 75-78.3 78.3-52.7 4.2-96.3-39.5-92.1-92.1 3.3-41.4 36.8-75 78.3-78.3 52.6-4.2 96.2 39.5 92.1 92.1z"}}),e("path",{attrs:{d:"M244.625 188.615c-30.4 0-55.2 24.8-55.2 55.2 0 7.3 5.9 13.2 13.2 13.2s13.2-5.9 13.2-13.2c0-15.9 12.9-28.8 28.8-28.8 7.3 0 13.2-5.9 13.2-13.2s-6-13.2-13.2-13.2z"}})])]):n._e()])],n._v(" "),e("div",{staticClass:"below"},[e("transition",{attrs:{name:"fade-fast",mode:"out-in"}},[n.loading?e("div",{key:"1",staticClass:"below-input-msg loading",attrs:{"data-test":"loading-state"}},[e("span",{staticClass:"loading-icon"}),n._v(" Loading...\n\t\t\t\t\t\t\t")]):e("div",{key:"2"},[e("smooth-height",{attrs:{duration:200}},[n.errorMsg?e("div",{key:n.errorMsg,staticClass:"below-input-msg error-message",attrs:{"data-test":"error-msg"},domProps:{innerHTML:n._s(n.errorMsg)}}):n.currentTip?e("div",{key:n.currentTip,staticClass:"below-input-msg tip",attrs:{"data-test":"introduction-tip"},domProps:{innerHTML:n._s(n.currentTip)}}):n._e()]),n._v(" "),e("transition",{attrs:{name:"fade-fast",mode:"out-in"}},[n.showContinueBtn?e("div",{staticClass:"continue-button-wrapper"},[e("button",{staticClass:"button dash-button button-continue",attrs:{"data-test":"continue-button"},on:{click:function(t){return t.stopPropagation(),n.setValue(t)}}},[n._v("\n\t\t\t\t\t\t\t\t\t\t\tContinue\n\t\t\t\t\t\t\t\t\t\t\t"),e("span",{staticClass:"icon"},[e("svg",{staticClass:"icon-next",attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 55.752 55.752"}},[e("path",{attrs:{d:"M43.006 23.916a5.36 5.36 0 0 0-.912-.727L20.485 1.581a5.4 5.4 0 1 0-7.637 7.638l18.611 18.609-18.705 18.707a5.398 5.398 0 1 0 7.634 7.635l21.706-21.703a5.35 5.35 0 0 0 .912-.727 5.373 5.373 0 0 0 1.574-3.912 5.363 5.363 0 0 0-1.574-3.912z"}})])])])]):n._e()])],1)])],1)],2):n._e()])],1),n._v(" "),e("div",{staticClass:"intro-bottom"},[e("div",{staticClass:"intro-bottom-wrapper"},[e("transition",{attrs:{name:"fade",mode:"out-in"}},[n.activeStep?e("div",{key:n.activeStepId,staticClass:"intro-buttons"},n._l(n.overrideButtons||n.activeStep.buttons,(function(t){return e("button",{key:t.text,staticClass:"button dash-button",attrs:{"data-test":t.dataTest},on:{click:function(n){return n.stopPropagation(),t.action()}}},[e("span",{staticClass:"icon",domProps:{innerHTML:n._s(t.icon)}}),n._v(n._s(t.text))])})),0):n._e()])],1),n._v(" "),e("div",{staticClass:"scrim"})])]):n._e()])};i._withStripped=!0;const s={SERVER_ERROR_GENERAL:"Sorry, we're having trouble connecting to our server. Please try again.",NAME_EMPTY:"Please let us know how to address you.",EMAIL_INVALID:"Sorry, {0} doesn't seem to be a valid email address. Please try again.",EMAIL_EMPTY:"Please enter an email.",PASSWORD_INVALID:"Passwords need to be at least 6 characters long.",EMAIL_NO_SPACES:"Emails may not include spaces",PASSWORD_INCORRECT:"The password you entered for<br>the email {0} isn't right.",TOO_MANY_ATTEMPTS:"Your account has been locked due to too many incorrect password attempts. Please try again in 5 minutes."};var o=e(4649);const r="0",l="1",c={name:"Introduction",components:{SmoothHeight:o.default},unreactive(){return{brandingInfoBase:{messageTemplate:"Logging in to {{ companyName }}...",subMessageTemplate:"Redirecting to {{ idProviderName }} to verify your account."},steps:{[r]:{message:"Hello, what's your name?",dataTest:"introduction-name",valueType:"name",onShow:()=>m.sendEvent("Introduction","Name","Show"),validation:()=>(m.sendEvent("Introduction","Name","Submit"),this.inputValue.trim().length?(m.models.customization.save({displayname:this.inputValue}),localStorage.setItem("tokenNeeded",!0),!0):(this.setError(s.NAME_EMPTY),!1)),nextStep:l},[l]:{message:"What's your email, {name}?",dataTest:"introduction-email",valueType:"email",inputType:"email",stayLoggedOut:!0,validation:()=>(m.sendEvent("Introduction","Email","Submit"),this.inputValue.trim().length?m.utils.validateEmail(this.inputValue)?(localStorage.email=this.email,!0):(this.setError(s.EMAIL_INVALID.replace("{0}",this.inputValue)),!1):(this.setError(s.EMAIL_EMPTY),!1)),beforeNextStep:()=>new Promise(((n,t)=>this.checkEmail().then((t=>{if(t&&t.managedDomain){this.isThirdPartyEmail=!0;let n=Object.assign({},this.brandingInfoBase,t.brandingInfo);this.thirdPartyMsg=n.message||n.messageTemplate.replace("{{ companyName }}",n.companyName).replace("{{ idProviderName }}",n.idProviderName),this.currentTip=n.subMessage||n.subMessageTemplate.replace("{{ companyName }}",n.companyName).replace("{{ idProviderName }}",n.idProviderName),m.commandManager.execute("auth.thirdparty",email)}else t.existingUser?this.nextStep=t.invitePending?"6":"3":404===t&&(this.nextStep="2");n(t)})).catch((n=>{this.setError(s.SERVER_ERROR_GENERAL),t(n)})))),buttons:[{icon:'<svg class="icon-back" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 55.753 55.753"><path d="M12.745 23.915c.283-.282.59-.52.913-.727L35.266 1.581a5.4 5.4 0 1 1 7.637 7.638L24.294 27.828l18.705 18.706a5.4 5.4 0 0 1-7.636 7.637L13.658 32.464a5.367 5.367 0 0 1-.913-.727 5.367 5.367 0 0 1-1.572-3.911 5.369 5.369 0 0 1 1.572-3.911z"/></svg>',text:"Change name",action:()=>{m.sendEvent("Introduction","Email","Change name"),this.goToStep(r)},dataTest:"use-different-name-button"},{icon:'<svg class="icon-skip" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 491.807 491.807"><path d="M485.802 221.184l-184.32-184.32a20.506 20.506 0 0 0-22.323-4.444c-7.659 3.154-12.636 10.65-12.636 18.924v82.002c-117.842 4.833-220.651 84.398-253.583 198.41C-1.314 381.195-.208 421.356.201 436.491l.082 3.973c0 9.216 6.164 17.306 15.032 19.743 1.823.492 3.645.737 5.448.737a20.51 20.51 0 0 0 17.592-9.994c81.121-136.356 188.6-140.227 228.168-136.376v105.411c0 8.274 4.977 15.77 12.636 18.924 7.68 3.195 16.466 1.413 22.323-4.444l184.32-184.32c8.007-8.01 8.007-20.954 0-28.961z"/></svg>',text:"Stay logged out",action:()=>{m.sendEvent("Introduction","Email","Stay Offline Clicked"),this.stayOffline()},dataTest:"stay-logged-out-button"}]},2:{message:"Please choose a password.",dataTest:"introduction-create-password",valueType:"password",inputType:"password",inputClass:"password-input",onShow:()=>this.currentTip='Momentum respects your privacy. Learn more in our <a href="https://momentumdash.com/legal" target="_blank">Terms & Privacy Policy</a>.',validation:()=>(m.sendEvent("Introduction","Password For Create","Submit"),this.validatePassword(this.inputValue)),beforeNextStep:()=>new Promise(((n,t)=>this.register().then(n).catch((n=>{n.message?this.setError(n.message):this.setError(s.SERVER_ERROR_GENERAL),t(n)})))),afterSuccess:()=>this.loginComplete(),prevStep:l,buttons:[{icon:'<svg class="icon-back" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 55.753 55.753"><path d="M12.745 23.915c.283-.282.59-.52.913-.727L35.266 1.581a5.4 5.4 0 1 1 7.637 7.638L24.294 27.828l18.705 18.706a5.4 5.4 0 0 1-7.636 7.637L13.658 32.464a5.367 5.367 0 0 1-.913-.727 5.367 5.367 0 0 1-1.572-3.911 5.369 5.369 0 0 1 1.572-3.911z"/></svg>',text:"Email",action:()=>this.goToStep(l),dataTest:"use-different-email-button"}]},3:{message:"What's your password?",dataTest:"introduction-prompt-password",valueType:"password",inputType:"password",inputClass:"password-input",validation:()=>(m.sendEvent("Introduction","Password For Login","Submit"),this.validatePassword(this.inputValue)),beforeNextStep:()=>new Promise(((n,t)=>this.login().then(n).catch((n=>{400===n.status||401===n.status?this.setError(s.PASSWORD_INCORRECT.replace("{0}",this.email)):429===n.status?this.setError(s.TOO_MANY_ATTEMPTS):this.setError(s.SERVER_ERROR_GENERAL),t(n)})))),prevStep:l,afterSuccess:n=>this.successfulLogin(n),buttons:[{icon:'<svg class="icon-back" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 55.753 55.753"><path d="M12.745 23.915c.283-.282.59-.52.913-.727L35.266 1.581a5.4 5.4 0 1 1 7.637 7.638L24.294 27.828l18.705 18.706a5.4 5.4 0 0 1-7.636 7.637L13.658 32.464a5.367 5.367 0 0 1-.913-.727 5.367 5.367 0 0 1-1.572-3.911 5.369 5.369 0 0 1 1.572-3.911z"/></svg>',text:"Email",action:()=>this.goToStep(l),dataTest:"use-different-email-button"},{icon:'<svg class="icon-password" viewBox="0 0 506.34 506.34" xmlns="http://www.w3.org/2000/svg"><path d="M481.162 395.052L283.465 197.354c9.939-23.978 13.243-50.72 9.301-76.499C275.176 5.869 132.419-41.309 50.03 42.757c-54.698 55.81-54.317 145.219 1.028 200.564 42.499 42.498 104.556 52.174 155.652 30.818l111.077 111.077-19.467 19.467c-15.1 15.099-15.1 39.668 0 54.768l35.537 35.537c15.134 15.134 39.632 15.137 54.768 0l19.642-19.642c9.697 8.015 21.769 12.375 34.51 12.375 48.737 0 72.161-58.894 38.385-92.669zM180.374 171.033c-15.748 15.748-41.28 15.748-57.028 0s-15.748-41.28 0-57.028 41.28-15.748 57.028 0 15.748 41.281 0 57.028z"/></svg>',text:"Change password",action:()=>{m.sendEvent("Introduction","Password For Login","Reset Password Clicked"),this.goToStep("4")},dataTest:"reset-password-button"}]},4:{message:"What would you like your new password to be?",dataTest:"introduction-reset-password",valueType:"password",inputType:"password",inputClass:"password-input",prevStep:l,onShow:()=>{m.sendEvent("Introduction","Password For Reset","Show"),this.currentTip=`Changing password for ${this.email}.`},validation:()=>(m.sendEvent("Introduction","Password For Reset","Submit"),this.validatePassword(this.inputValue)),beforeNextStep:()=>new Promise(((n,t)=>this.resetPassword().then((t=>{this.afterFadeOutCallback=function(){m.commandManager.execute("notification.show.enhanced",{priority:1,title:"Confirm new password",message:"A verification email will be sent to you shortly. To finish changing your password, click the link in the email."})},this.clearIntroduction(),n(t)})).catch((n=>{this.setError(s.SERVER_ERROR_GENERAL),t(n)})))),buttons:[{icon:'<svg class="icon-back" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 55.753 55.753"><path d="M12.745 23.915c.283-.282.59-.52.913-.727L35.266 1.581a5.4 5.4 0 1 1 7.637 7.638L24.294 27.828l18.705 18.706a5.4 5.4 0 0 1-7.636 7.637L13.658 32.464a5.367 5.367 0 0 1-.913-.727 5.367 5.367 0 0 1-1.572-3.911 5.369 5.369 0 0 1 1.572-3.911z"/></svg>',text:"Email",action:()=>{m.sendEvent("Introduction","Password For Reset","Change Email Clicked"),this.goToStep(l)},dataTest:"use-different-email-button"}]},5:{prevStep:l,hideInput:!0,buttons:[{icon:'<svg class="icon-back" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 55.753 55.753"><path d="M12.745 23.915c.283-.282.59-.52.913-.727L35.266 1.581a5.4 5.4 0 1 1 7.637 7.638L24.294 27.828l18.705 18.706a5.4 5.4 0 0 1-7.636 7.637L13.658 32.464a5.367 5.367 0 0 1-.913-.727 5.367 5.367 0 0 1-1.572-3.911 5.369 5.369 0 0 1 1.572-3.911z"/></svg>',text:"Email",action:()=>{m.sendEvent("Introduction","Third Party Login","Return to Login Clicked"),localStorage.removeItem("onetimeSent"),this.name?this.goToStep(l):this.goToStep(r)},dataTest:"use-different-email-button"}]},6:{hideInput:!0,stepClass:"message",message:"Please check your email for an invitation to your Momentum team account."}}}},data:()=>({showIntro:!0,nextStep:null,activeStepId:"",name:m.models.customization.get("displayname")||"",email:localStorage.email||"",isThirdPartyEmail:!1,thirdPartyMsg:"",password:"",loading:!1,currentTip:"",errorMsg:"",showContinueBtn:!1,inputValue:"",overrideButtons:null,showInputText:!1}),computed:{activeStep(){return this.steps[this.activeStepId]},passwordVisibilityTitle(){return this.showInputText?"Hide password":"Reveal password"},message(){return this.activeStep.message.replace("{name}",this.name)},hiddenSpanValue(){return this.inputValue?"password"!==this.activeStep.inputType||this.showInputText?this.inputValue.replace(/ /g," ")||" ":new Array(this.inputValue.length+1).join("•"):" "}},created(){m.introductionActive=!0,this.$e.listenTo(m,"globalEvent:esc",this.handleEsc),window.addEventListener("keyup",this.onEnterOrTab),localStorage.removeItem("doLoginOnNextLoad"),m.widgetManager.hideAppsExcept(".apps .full",!0);const n=localStorage.getItem("loginParams");n?(this.goToStep("3"),this.processPendingLogin(n)):this.name?this.goToStep(l):this.goToStep(r)},mounted(){document.body.classList.add("hide-overlay"),"none"===document.getElementById("main-view").style.display?this.$e.listenToOnce(m,"appsReady",this.focusInput):this.focusInput()},destroyed(){window.removeEventListener("keyup",this.onEnterOrTab),this.$e.stopListening(m,"globalEvent:esc",this.handleEsc),document.body.classList.remove("hide-overlay"),m.introductionActive=!1,m.onboardingEnabled&&!this.onboardingSkipped||m.models.notificationManager.displayPendingMessages()},methods:{handleSpaceInput(n){"email"==this.activeStep.inputType&&(n.preventDefault(),this.setError(s.EMAIL_NO_SPACES))},onKeydown(n){n&&"`"===n.key&&m.trigger("globalEvent:key:backtick"),this.errorMsg=""},onEnterOrTab(n){"Enter"!==n.key&&"Tab"!==n.key||this.setValue()},focusInput(){const n=this.$refs.input;n&&setTimeout((()=>{n.focus(),"email"!==this.activeStep.inputType&&(n.selectionStart=n.selectionEnd=n.value.length),n.scrollLeft=n.scrollWidth}),0)},processPendingLogin(n){let t={},e=localStorage.getItem("pendingLoginState");e&&(t.pendingState=e),n&&(t.loginParams=n),this.setLoadingState(),$.ajax({type:"POST",contentType:"application/json",data:JSON.stringify(t),url:m.globals.urlRootLogin+"user/authenticate"}).done((n=>{this.loading=!1,localStorage.removeItem("loginParams"),this.successfulLogin(n,!0)})).fail((n=>{if(this.loading=!1,localStorage.removeItem("onetimeSent"),localStorage.removeItem("loginParams"),401===n.status){this.email=localStorage.getItem("email");let n=`The one-time link ${this.email&&" for "+this.email} has expired. ${this.email&&" Try sending a new one-time login link to the same email, or use a different email address."}`;this.setError(n),this.name=m.models.customization.get("displayname"),this.name?this.overrideButtons.push({text:"Use a different email",action:()=>this.goToStep(l),dataTest:"use-different-email-button"}):this.overrideButtons.push({text:"Enter your name",action:()=>{m.sendEvent("Introduction","Enter Password","Enter Your Name Clicked"),this.goToStep(r)},dataTest:"enter-your-name-button"})}else this.setError(s.SERVER_ERROR_GENERAL)})),localStorage.removeItem("pendingLoginState")},successfulLogin(n={},t){m.delayOnboardingForIntro=!0;const e=localStorage.getItem("user_uuid");localStorage.removeItem("unregistered"),localStorage.removeItem("registrationStatePending"),!t||e&&e===n.user_uuid||m.commandManager.execute("user.cleanup",{type:"all"}),n.token&&(localStorage.removeItem("registrationStatePending"),m.commandManager.execute("notification.dismiss"),n.token&&(localStorage.setItem("token",n.token),m.usage.setup(m.globals.urlRootStats,m.globals.version,localStorage.getItem("client_uuid"),n.token)),n.token_uuid&&localStorage.setItem("token_uuid",n.token_uuid),n.user_uuid&&localStorage.setItem("user_uuid",n.user_uuid),n.features&&m.conditionalFeatures.setFeatures(n.features),n.settings&&m.syncCoordinator.loadSettings(n.settings),this.loginComplete())},loginComplete(){m.trigger("user:successfulLogin",(()=>{localStorage.setItem("loggedIn",m.now()),localStorage.removeItem("onetimeSent"),this.clearIntroduction()}))},clearIntroduction(){const n=(n,t)=>{this.clearMessages(),clearTimeout(this.onboardingTimeout),this.showIntro=!1,this.onboardingSkipped=n,this.keepAppsHidden=t};localStorage.removeItem("doLoginOnNextLoad"),m.readyForWidgets=!0,m.conditionalFeatures.featureEnabled("team")&&document.getElementsByTagName("body")[0].classList.add("has-team"),m.appsReady=!1,m.trigger("readyForWidgets"),this.$e.listenToOnce(m,"appsReady",(function(){m.onboardingEnabled?(this.onboardingTimeout=setTimeout((()=>{this.$e.stopListening(m,"onboarding:stepsAnalyzed",n),m.usage&&m.usage.saveError({errorType:"introductionTimeout",errorMessage:"onboarding time limit exceeded"}),n(!0)}),5e3),this.$e.listenToOnce(m,"onboarding:stepsAnalyzed",n),m.widgetManager.loadWidget("modal")):n(!1,!1)}))},stayOffline(){m.delayOnboardingForIntro=!0,localStorage.stayOffline=!0,localStorage.removeItem("onetimeSent"),localStorage.removeItem("pendingLoginState"),localStorage.removeItem("loginParams"),localStorage.getItem("unregistered")&&localStorage.getItem("token")?this.clearIntroduction():(this.setLoadingState(),$.ajax({type:"POST",contentType:"application/json",data:JSON.stringify({name:m.models.customization.get("displayname"),version:m.globals.version}),url:m.globals.urlRootLogin+"user/register?canceled=true"}).done((n=>{m.delayOnboardingForIntro=!0,n.token&&(localStorage.token=n.token,n.token_uuid&&(localStorage.token_uuid=n.token_uuid),n.settings&&m.syncCoordinator.loadSettings(n.settings),localStorage.setItem("unregistered",!0),localStorage.removeItem("registrationStatePending")),n.successfulRegister=!0,n.settings&&m.syncCoordinator.loadSettings(n.settings),this.loginComplete()})).fail((function(n){n.message=n.responseJSON&&n.responseJSON.msg||"An error occurred. Please try again shortly.",reject(n)})))},checkEmail(){return new Promise(((n,t)=>{let e=m.globals.urlRootApi+"user-search?email="+encodeURIComponent(this.email);$.ajax({type:"GET",contentType:"application/json",url:e}).done((t=>{t&&t.managedDomain?t.brandingInfo=t.brandingInfo||{}:t.existingUser=!0,n(t)})).fail((e=>{404===e.status?n(e.status):t(e)}))}))},validatePassword(n){return!(n.length<6&&(this.setError(s.PASSWORD_INVALID),1))},register(){return new Promise(((n,t)=>{const e=this.email,a=this.password,i=this.name,s=m.globals.urlRootLogin+"user/register";$.ajax({type:"POST",contentType:"application/json",data:JSON.stringify({name:i,email:e,password:a,invite:null,version:m.globals.version}),url:s}).done((t=>{m.delayOnboardingForIntro=!0,t.token?(localStorage.token=t.token,t.token_uuid&&(localStorage.token_uuid=t.token_uuid)):t.first_time_key&&(localStorage.first_time_key=t.first_time_key,localStorage.next_login_attempt=m.now(),t.token_uuid&&(localStorage.token_uuid=t.token_uuid)),localStorage.removeItem("unregistered"),localStorage.removeItem("registrationStatePending"),t.settings&&m.syncCoordinator.loadSettings(t.settings),t.successfulRegister=!0,n(t)})).fail((n=>{n.message=n.responseJSON&&n.responseJSON.msg||"An error occurred during registration. Please try again shortly.",t(n)}))}))},login(){return new Promise(((n,t)=>{const e=this.email,a=this.password,i=m.globals.urlRootLogin+"user/authenticate";$.ajax({type:"POST",contentType:"application/json",data:JSON.stringify({username:e,password:a}),url:i}).done((function(t){t.successfulLogin=!0,n(t)})).fail((function(n){t(n)}))}))},resetPassword(){return new Promise(((n,t)=>{const e=this.email,a=this.password,i=this.name;$.ajax({type:"POST",contentType:"application/json",data:JSON.stringify({name:i,email:e,password:a}),url:m.globals.urlRootLogin+"user/forgot"}).done((function(t){m.delayOnboardingForIntro=!0,n(t)})).fail(t)}))},togglePasswordVisibility(){this.showInputText=!this.showInputText,this.focusInput()},setError(n){this.loading=!1,this.errorMsg=n},clearMessages(){this.currentTip="",this.loading=!1,this.errorMsg="",this.showContinueBtn=!1},setLoadingState(){this.showContinueBtn=!1,this.loading=!0,this.errorMsg=""},setValue(){this[this.activeStep.valueType]=this.inputValue,(this.activeStep.validation&&this.activeStep.validation()||!this.activeStep.validation)&&(this.activeStep.beforeNextStep?(this.setLoadingState(),Promise.resolve(this.activeStep.beforeNextStep()).then((n=>{this.activeStep.afterSuccess&&this.activeStep.afterSuccess(n),(this.activeStep.nextStep||this.nextStep)&&this.goToStep(this.activeStep.nextStep||this.nextStep)})).catch(console.error)):(this.activeStep.nextStep||this.nextStep)&&this.goToStep(this.activeStep.nextStep||this.nextStep))},goToStep(n){this.inputValue="",this.overrideButtons=null,this.nextStep=null,clearTimeout(this.timeout),this.clearMessages(),this.activeStepId=n,this.activeStep.onShow&&this.activeStep.onShow()},handleEsc(){this.activeStep.stayLoggedOut?this.stayOffline():this.activeStep.prevStep&&this.goToStep(this.activeStep.prevStep)},onInput(){clearTimeout(this.timeout),this.timeout=setTimeout((()=>{this.showContinueBtn=!0}),5e3)},destroy(){this.$parent.$el.remove(),this.$parent.$destroy()},afterLeave(){m.appView.render(!0,(()=>{this.keepAppsHidden&&$(".apps").addClass("hide-apps"),m.widgetManager.showApps(!0),m.trigger("weather:reset"),this.onboardingSkipped||m.trigger("onboarding:initialize"),m.widgetManager.setBottomSideWidth()})),"function"==typeof this.afterFadeOutCallback&&this.afterFadeOutCallback(),this.destroy()}}};e(5278);var d=(0,e(1900).Z)(c,i,[],!1,null,"28e1c6fc",null);d.options.__file="source/addins-vue/introduction/Introduction.vue";const u=d.exports;e(1238).Z.directive("focus",{inserted:function(n,t){!1!==t.value&&n.focus()}});const p=document.createElement("div");document.querySelector(".region.full").appendChild(p),new a.Z({render:n=>n(u)}).$mount(p);const h={}},1940:(n,t,e)=>{"use strict";e.d(t,{Z:()=>a});const a={data:()=>({componentsMounted:{}}),unreactive:()=>({uid:m.utils.shortId()}),beforeCreate(){const n=this.$options.components;Object.keys(n).forEach((t=>{const e=n[t];"function"==typeof e&&(n[t]=function(){this.$set(this.componentsMounted,t,!1);const n=`${t}:${this.uid}:mounted`,a=()=>this.componentsMounted[t]=!0;return this.$e.$once(n,a),e(arguments).then((e=>{const i=e.default;return i&&i.doNotWaitForMount&&(this.$delete(this.componentsMounted,t),this.$e.$off(n,a)),e}))}.bind(this))}))},mounted(){if(Object.keys(this.componentsMounted).length){const n=this.$watch("componentsMounted",(t=>{Object.values(t).every((n=>n))&&(this.onAllComponentsMounted(),n())}),{deep:!0,immediate:!0})}else this.onAllComponentsMounted()},methods:{getContextUid(){return this.$vnode&&this.$vnode.context&&this.$vnode.context.uid||""},onAllComponentsMounted(){this.$options.widgetId?m.widgetManager.appReady(this.$options.widgetId):this.$e.$emit(`${this.$options.name}:${this.getContextUid()}:mounted`)}}}},4525:(n,t,e)=>{"use strict";e.d(t,{Z:()=>l});var a=e(1238),i=e(1018),s=e(7366),o=e.n(s),r=e(2096);a.Z.use(i.Z,{name:"unreactive"}),a.Z.use(o()),a.Z.prototype.$e=r.Z,new a.Z({bb:()=>({conditionalFeatures:m.conditionalFeatures,teamInfo:m.models.teamInfo})}),a.Z.mixin({computed:{$plus:()=>m.conditionalFeatures.featureEnabled("plus"),$team:()=>m.conditionalFeatures.featureEnabled("team"),$admin:()=>m.models.teamInfo&&m.models.teamInfo.get("team")&&m.models.teamInfo.get("team").userIsAdmin}});const l=a.Z},5662:(n,t,e)=>{(n.exports=e(7788)(!1)).push([n.id,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/* Putting this here for now before generalizing */\n/* TODO: Remove when generalized; */\n.scrim[data-v-28e1c6fc]:before, .u--scrim[data-v-28e1c6fc]:before { --size: -90px; --h-factor: 1.25; --v-factor: 0.75; position: absolute; top: calc(var(--size) * var(--v-factor)); right: calc(var(--size) * var(--h-factor)); bottom: calc(var(--size) * var(--v-factor)); left: calc(var(--size) * var(--h-factor)); z-index: -1; opacity: 0.3; background: radial-gradient(closest-side, hsl(0, 0%, 0%), hsla(0, 0%, 0%, 0.98032) 13.81%, hsla(0, 0%, 0%, 0.92593) 25.46%, hsla(0, 0%, 0%, 0.84375) 35.31%, hsla(0, 0%, 0%, 0.74074) 43.7%, hsla(0, 0%, 0%, 0.62384) 50.98%, hsla(0, 0%, 0%, 0.5) 57.5%, hsla(0, 0%, 0%, 0.37616) 63.6%, hsla(0, 0%, 0%, 0.25926) 69.63%, hsla(0, 0%, 0%, 0.15625) 75.94%, hsla(0, 0%, 0%, 0.07407) 82.87%, hsla(0, 0%, 0%, 0.01968) 90.78%, hsla(0, 0%, 0%, 0)); content: ''; filter: none; /* <-- needed to cancel out existing general filter */\n}\n.fade-fast-enter-active[data-v-28e1c6fc], .fade-fast-leave-active[data-v-28e1c6fc] { transition: opacity 0.25s var(--a-curve);\n}\n.fade-fast-enter[data-v-28e1c6fc], .fade-fast-leave-to[data-v-28e1c6fc] { opacity: 0;\n}\n.intro[data-v-28e1c6fc] { --margin: 20px; height: 100vh; display: flex; flex-direction: column; line-height: normal;\n}\n.intro .button[data-v-28e1c6fc] { margin-right: 18px;\n}\n.intro .button[data-v-28e1c6fc]:last-child { margin-right: 0;\n}\n.button .icon[data-v-28e1c6fc] svg { height: 11px; margin-left: -5px; margin-right: 10px; opacity: 0.7; fill: white;\n}\n.intro-top[data-v-28e1c6fc], .intro-bottom[data-v-28e1c6fc] { padding: var(--margin) 0; flex: 0 0 120px;\n}\n.intro-top[data-v-28e1c6fc] {\n}\n.logo[data-v-28e1c6fc] { --size: 80px; height: var(--size); width: var(--size); border-radius: 100%; box-shadow: 0 0 50px rgba(0,0,0,0.1);\n}\n.intro-middle[data-v-28e1c6fc] { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center;\n}\n.intro-middle .u--scrim[data-v-28e1c6fc]:before { opacity: 0.35;\n}\n.intro-middle-wrapper[data-v-28e1c6fc] { max-width: 100%; padding: 0 40px; position: relative; top: -8px; /* <-- vertical center to make up for gap above heading text */ display: inline-flex; flex-direction: column; align-items: center;\n}\n.question[data-v-28e1c6fc] { padding-bottom: 15px; line-height: 1.2; white-space: normal;\n}\n.input-wrapper[data-v-28e1c6fc] {\n\t\t\t\t--pass-vis-icon-width: 25px;\n\t\t\t\t--pass-vis-icon-side-padding: 8px;\n\t\t\t\t--pass-vis-width: calc(var(--pass-vis-icon-width) + var(--pass-vis-icon-side-padding));\n\t\t\t\tmax-width: 100%; position: relative; display: flex; justify-content: space-between; align-self: stretch; font-weight: 500; border-bottom: 3px solid #fff;\n}\n.input-wrapper.has-text-input[data-v-28e1c6fc] { padding: 0;\n}\n\n\t\t\t\t/*\n\t\t\t\tWhen right and left columns are present (password):\n\t\t\t\t- Right column should never shrink at all or be pushed outside the input.\n\t\t\t\t- Left column should give way to text as soon as text reaches that column so that the text can fill the entire input.\n\t\t\t\t- There should be no extra padding on the left once the input is expanding.\n\t\t\t\t- The bullets or text should not be clipped unless the input is a max width.\n\t\t\t\t- Text should be centred relative to the underline until it reaches the left column.\n\t\t\t \t- Once it expands into the left column should be centred relative to the left and center columns\n\t\t\t\t*/\n.input-left-column[data-v-28e1c6fc] { flex: 0 9999999 var(--pass-vis-width);\n} /* 9999999 ensures this column shrinks immediately */\n.input-center-column[data-v-28e1c6fc] { min-width: 0; position: relative; flex: 1 1 auto; overflow: hidden;\n} /* flex-shrink: 1; min-width: 0; so that this column does not push the right outside of the input */\n.input[data-v-28e1c6fc] { width: 100%; padding: 0; position: absolute; top: 0; right: 0; bottom: 0; left: 0; border: none; font-weight: 500; line-height: normal; outline: none; text-align: center;\n}\n.Safari input[data-v-28e1c6fc]::-webkit-contacts-auto-fill-button, .Safari input[data-v-28e1c6fc]::-webkit-credentials-auto-fill-button { visibility: hidden; position: absolute; pointer-events: none; right: 0;\n} /* hide key icon & dropdown in password input */\n.input[data-v-28e1c6fc]::-ms-reveal { display: none;\n}\n.hidden-span[data-v-28e1c6fc] { visibility: hidden;\n}\n.input-right-column[data-v-28e1c6fc] { padding: 0 0 0 var(--pass-vis-icon-side-padding); flex: 0 0 auto; background: transparent; border: none; cursor: pointer;\n}\n.input-right-column[data-v-28e1c6fc]:focus { outline: none;\n}\n.password-visibility-icon[data-v-28e1c6fc] { width: var(--pass-vis-icon-width);\n}\n.below[data-v-28e1c6fc] { position: absolute; top: 100%; left: 0; right: 0; font-size: 1rem; /* <-- reset giant font set on .intro class */\n}\n.below-input-msg[data-v-28e1c6fc] { margin: 2rem 20px 0; font-size: 1.1875rem; text-align: center; white-space: normal; -webkit-user-select: text; -moz-user-select: text; user-select: text;\n}\n.tip[data-v-28e1c6fc] { line-height: 150%;\n}\n.tip[data-v-28e1c6fc] a { text-decoration: underline !important; white-space: nowrap;\n}\n.loading-icon[data-v-28e1c6fc] { vertical-align: baseline;\n}\n.continue-button-wrapper[data-v-28e1c6fc] { margin-top: 2rem;\n}\n.intro .button.button-continue .icon-next[data-v-28e1c6fc] { margin-left: 10px; margin-right: -5px; vertical-align: -5%;\n}\n.intro-bottom[data-v-28e1c6fc] { position: relative; display: flex; align-items: flex-end; justify-content: center; font-size: 1.125rem;\n}\n.intro-bottom .scrim[data-v-28e1c6fc] { position: absolute; bottom: 0;\n}\n.intro-bottom .scrim[data-v-28e1c6fc]:before { --size: -600px; --h-factor: 1; --v-factor: 0.38;\n}\n@media screen and (max-height: 500px) {\n.intro[data-v-28e1c6fc] { --margin: 1rem;\n}\n.intro-top[data-v-28e1c6fc], .intro-bottom[data-v-28e1c6fc] { flex-basis: auto;\n}\n.logo[data-v-28e1c6fc] { --size: 60px;\n}\n}\n\n",""])},5278:(n,t,e)=>{var a=e(5662);"string"==typeof a&&(a=[[n.id,a,""]]),a.locals&&(n.exports=a.locals),(0,e(1372).Z)("a992c826",a,!1,{ssrId:!0})}}]);